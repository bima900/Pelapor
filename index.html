<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Aplikasi Laporan Lingkungan (Online)</title>
Â  Â  <style>
Â  Â  Â  Â  /* CSS Mobile-First */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  background-color: #f0f2f5;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  -webkit-tap-highlight-color: transparent; /* Untuk mobile */
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background-color: #fff;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  padding-bottom: 70px; /* Ruang untuk menu bawah */
Â  Â  Â  Â  }
Â  Â  Â  Â  header {
Â  Â  Â  Â  Â  Â  background-color: #17a2b8;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 15px 20px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-size: 1.2em;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .content-section {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .content-section.active {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Form Styling */
Â  Â  Â  Â  form label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  color: #495057;
Â  Â  Â  Â  }
Â  Â  Â  Â  form input, form select, form textarea {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ced4da;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  }
Â  Â  Â  Â  form textarea {
Â  Â  Â  Â  Â  Â  resize: vertical;
Â  Â  Â  Â  }
Â  Â  Â  Â  form button {
Â  Â  Â  Â  Â  Â  background-color: #28a745;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  margin-top: 30px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  form button:active {
Â  Â  Â  Â  Â  Â  background-color: #1e7e34;
Â  Â  Â  Â  }
Â  Â  Â  Â  .status-message {
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .status-success {
Â  Â  Â  Â  Â  Â  background-color: #d4edda;
Â  Â  Â  Â  Â  Â  color: #155724;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Tanggapan Styling */
Â  Â  Â  Â  .response-card {
Â  Â  Â  Â  Â  Â  background-color: #e9f7fe;
Â  Â  Â  Â  Â  Â  border: 1px solid #bce8f1;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .response-card strong {
Â  Â  Â  Â  Â  Â  color: #0c5460;
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .response-card .laporan-isi {
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  Â  Â  color: #6c757d;
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .loading {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  color: #6c757d;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Menu Bawah (Navigasi Mobile) */
Â  Â  Â  Â  .bottom-nav {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  bottom: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  right: 0;
Â  Â  Â  Â  Â  Â  height: 60px;
Â  Â  Â  Â  Â  Â  background-color: #fff;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item {
Â  Â  Â  Â  Â  Â  flex: 1;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 10px 0;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  color: #6c757d;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  transition: color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item.active {
Â  Â  Â  Â  Â  Â  color: #17a2b8;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item i {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 2px;
Â  Â  Â  Â  }
Â  Â  </style>
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">Â 
</head>
<body>

Â  Â  <div class="container">
Â  Â  Â  Â  <header>Lapor Lingkungan Real-Time</header>

Â  Â  Â  Â  <div id="lapor" class="content-section active">
Â  Â  Â  Â  Â  Â  <h3>ğŸ“ Buat Laporan Online</h3>
Â  Â  Â  Â  Â  Â  <form id="laporan-form">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="nama">Nama Pelapor:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="nama" name="nama" required placeholder="Cth: Budi Santoso">

Â  Â  Â  Â  Â  Â  Â  Â  <label for="kategori">Kategori Masalah:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="kategori" name="kategori" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Pilih Kategori</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Sampah Menumpuk">Sampah Menumpuk</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Kebersihan Fasilitas Umum">Kebersihan Fasilitas Umum</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  Â  Â  <label for="isi">Isi Laporan (Detail):</label>
Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="isi" name="isi" rows="4" required placeholder="Jelaskan masalahnya secara detail..."></textarea>

Â  Â  Â  Â  Â  Â  Â  Â  <label for="lokasi">Lokasi Masalah:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="lokasi" name="lokasi" required placeholder="Alamat lengkap / koordinat / patokan">

Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" id="submit-button">Kirim Laporan Online</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="status-message" class="status-message status-success" style="display: none;"></div>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="tanggapan" class="content-section">
Â  Â  Â  Â  Â  Â  <h3>ğŸ’¬ Tanggapan Admin (Dinamis)</h3>
Â  Â  Â  Â  Â  Â  <div class="loading" id="tanggapan-loading">Memuat tanggapan terbaru...</div>
Â  Â  Â  Â  Â  Â  <div id="tanggapan-list">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="bottom-nav">
Â  Â  Â  Â  <div class="nav-item active" data-tab="lapor">
Â  Â  Â  Â  Â  Â  <i class="fas fa-bullhorn"></i>
Â  Â  Â  Â  Â  Â  Lapor
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" data-tab="tanggapan">
Â  Â  Â  Â  Â  Â  <i class="fas fa-comment-dots"></i>
Â  Â  Â  Â  Â  Â  Tanggapan
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // *** BAGIAN PENTING: GANTI DENGAN URL WEB APP GOOGLE APPS SCRIPT ANDA ***
Â  Â  Â  Â  const API_URL ='https://script.google.com/macros/s/AKfycbz6PYNYvhxauycsxHoCNsY25AsjaXwO6OPCGGUWeED6N8yXFgbmpHM4sSEP4EKVJLA4/exec';
Â  Â  Â  Â  // **********************************************************************
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Fungsionalitas Navigasi Tab
Â  Â  Â  Â  document.querySelectorAll('.nav-item').forEach(navItem => {
Â  Â  Â  Â  Â  Â  navItem.addEventListener('click', function() {
Â  Â  Â  Â  Â  Â  Â  Â  const targetId = this.getAttribute('data-tab');

Â  Â  Â  Â  Â  Â  Â  Â  // Update Navigasi
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
Â  Â  Â  Â  Â  Â  Â  Â  this.classList.add('active');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Update Konten
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll('.content-section').forEach(c => c.classList.remove('active'));
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById(targetId).classList.add('active');

Â  Â  Â  Â  Â  Â  Â  Â  // Muat tanggapan jika tab yang dipilih adalah 'tanggapan'
Â  Â  Â  Â  Â  Â  Â  Â  if (targetId === 'tanggapan') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fetchTanggapan();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  // 1. Fungsionalitas Pengiriman Laporan (POST)
Â  Â  Â  Â  const form = document.getElementById('laporan-form');
Â  Â  Â  Â  const statusMessage = document.getElementById('status-message');
Â  Â  Â  Â  const submitButton = document.getElementById('submit-button');

Â  Â  Â  Â  form.addEventListener('submit', function(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Tampilkan loading dan nonaktifkan tombol
Â  Â  Â  Â  Â  Â  submitButton.textContent = 'Mengirim...';
Â  Â  Â  Â  Â  Â  submitButton.disabled = true;
Â  Â  Â  Â  Â  Â  statusMessage.style.display = 'none';

Â  Â  Â  Â  Â  Â  // Kumpulkan data form
Â  Â  Â  Â  Â  Â  const formData = new FormData(form);
Â  Â  Â  Â  Â  Â  const payload = {};
Â  Â  Â  Â  Â  Â  for (let [key, value] of formData.entries()) {
Â  Â  Â  Â  Â  Â  Â  Â  payload[key] = value;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Kirim data ke Google Apps Script API
Â  Â  Â  Â  Â  Â  fetch(API_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json',
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(payload)
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  if (data.status === 'success') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'âœ… Laporan berhasil dikirim secara real-time!';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.classList.add('status-success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  form.reset();Â 
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'âŒ Gagal: ' + (data.message || 'Terjadi kesalahan.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.classList.remove('status-success');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.display = 'block';

Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  }, 5000);
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'âŒ Gagal terhubung ke server (Online diperlukan).';
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.classList.remove('status-success');
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error:', error);
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .finally(() => {
Â  Â  Â  Â  Â  Â  Â  Â  submitButton.textContent = 'Kirim Laporan Online';
Â  Â  Â  Â  Â  Â  Â  Â  submitButton.disabled = false;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });

Â  Â  Â  Â  // 2. Fungsionalitas Memuat Tanggapan (GET)
Â  Â  Â  Â  const tanggapanList = document.getElementById('tanggapan-list');
Â  Â  Â  Â  const tanggapanLoading = document.getElementById('tanggapan-loading');

Â  Â  Â  Â  function fetchTanggapan() {
Â  Â  Â  Â  Â  Â  tanggapanList.innerHTML = '';
Â  Â  Â  Â  Â  Â  tanggapanLoading.style.display = 'block';

Â  Â  Â  Â  Â  Â  // Ambil data Tanggapan dari Google Apps Script API
Â  Â  Â  Â  Â  Â  fetch(API_URL + '?action=get_responses') // Query parameter hanya untuk memastikan doGet terpanggil
Â  Â  Â  Â  Â  Â  .then(response => response.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  tanggapanLoading.style.display = 'none';

Â  Â  Â  Â  Â  Â  Â  Â  if (data.status === 'success' && data.data && data.data.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data.data.forEach(t => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Asumsi kolom di sheet Tanggapan adalah:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 'Timestamp', 'ID Laporan', 'Isi Laporan Pelapor', 'Tanggapan Admin'
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.classList.add('response-card');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Laporan (${t['ID Laporan'] || 'ID N/A'}):</strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="laporan-isi">${t['Isi Laporan Pelapor'] || 'Laporan Tidak Dikenal'}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <hr style="border: none; border-top: 1px dashed #bce8f1; margin: 10px 0;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>ğŸ’¬ Tanggapan Admin:</strong> ${t['Tanggapan Admin'] || 'Belum ada tanggapan.'}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small style="display: block; text-align: right; color: #888;">${new Date(t['Timestamp']).toLocaleString()}</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tanggapanList.appendChild(card);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tanggapanList.innerHTML = '<p style="text-align: center; color: #6c757d;">Belum ada tanggapan dari admin.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  tanggapanLoading.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  tanggapanList.innerHTML = '<p style="text-align: center; color: red;">Gagal memuat tanggapan. Cek koneksi internet Anda.</p>';
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error fetching responses:', error);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  // Muat tanggapan saat aplikasi dimuat pertama kali (jika ingin)
Â  Â  Â  Â  // fetchTanggapan();Â 
Â  Â  </script>
</body>
</html>
